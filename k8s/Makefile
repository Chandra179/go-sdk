NAMESPACE ?= dev
IMAGE ?= my-app
VERSION ?= latest
DOCKER_USER ?= c1789

.PHONY: minikube-start
minikube-start:
	./start-minikube.sh $(NAMESPACE)

apply:
	@if [ "$(word 2, $(MAKECMDGOALS))" = "" ]; then \
		echo "âŒ Usage: make apply <yaml-file>"; \
		exit 1; \
	fi; \
	FILE=$(word 2, $(MAKECMDGOALS)); \
	echo "ğŸš€ Applying $$FILE"; \
	kubectl apply -f $$FILE

restart:
	@if [ "$(word 2, $(MAKECMDGOALS))" = "" ]; then \
		echo "âŒ Usage: make restart <deployment-name>"; \
		exit 1; \
	fi; \
	DEPLOY=$(word 2, $(MAKECMDGOALS)); \
	echo "ğŸ”„ Restarting $$DEPLOY in namespace dev"; \
	kubectl rollout restart deployment/$$DEPLOY -n dev; \
	echo "âœ… Rollout done for $$DEPLOY"

# Prevent treating arguments as targets
%:
	@: